.tag {
  --#{$prefix}tag-gap: #{$tag-gap};
  --#{$prefix}tag-padding-x: #{$tag-padding-x};
  --#{$prefix}tag-padding-y: #{$tag-padding-y};
  @include rfs($tag-font-size, --#{$prefix}tag-font-size);
  --#{$prefix}tag-font-shift: #{$tag-font-shift}; // stylelint-disable-line custom-property-empty-line-before
  --#{$prefix}tag-font-weight: #{$tag-font-weight};
  --#{$prefix}tag-font-spacing: #{$tag-font-spacing};
  --#{$prefix}tag-icon-size: #{$tag-icon-size};
  --#{$prefix}tag-icon-margin-start: #{$tag-icon-margin-start};
  --#{$prefix}tag-close-size: #{add(var(--#{$prefix}tag-font-size), .375rem)};
  --#{$prefix}tag-close-margin-end: #{$tag-close-margin-end};
  --#{$prefix}tag-close-margin-start: #{$tag-close-margin-start};
  --#{$prefix}tag-border-width: #{$tag-border-width};
  --#{$prefix}tag-border-radius: #{$tag-border-radius};
  --#{$prefix}tag-border-color: #{$tag-border-color};
  --#{$prefix}tag-active-color: #{$tag-active-color};
  --#{$prefix}tag-active-decoration-color: #{$tag-active-decoration-color};
  --#{$prefix}tag-disabled-color: #{$tag-disabled-color};
  --#{$prefix}tag-outline-color: var(--#{$prefix}link-hover-color);

  display: inline-flex;
  gap: var(--#{$prefix}tag-gap);
  align-items: center;
  padding: subtract(var(--#{$prefix}tag-padding-y), calc(var(--#{$prefix}tag-font-shift) * .5)) var(--#{$prefix}tag-padding-x) add(var(--#{$prefix}tag-padding-y), calc(var(--#{$prefix}tag-font-shift) * .5)); // stylelint-disable-line function-disallowed-list
  @include font-size(var(--#{$prefix}tag-font-size));
  font-weight: var(--#{$prefix}tag-font-weight);
  line-height: add(var(--#{$prefix}tag-font-size), .125rem);
  color: inherit;
  letter-spacing: var(--#{$prefix}tag-font-spacing);
  background-color: transparent;
  border: var(--#{$prefix}tag-border-width) solid var(--#{$prefix}tag-border-color);
  outline-offset: $spacer;
  @include transition($transition-focus);
  @include border-radius(var(--#{$prefix}tag-border-radius), var(--#{$prefix}tag-border-radius));

  img,
  svg {
    width: var(--#{$prefix}tag-icon-size);
    min-width: var(--#{$prefix}tag-icon-size); // Here to avoid weird behavior on wrap
    height: var(--#{$prefix}tag-icon-size);
    margin: add(calc(var(--#{$prefix}tag-icon-size) * -.5), var(--#{$prefix}tag-font-shift)) 0 calc(var(--#{$prefix}tag-icon-size) * -.5) var(--#{$prefix}tag-icon-margin-start); // stylelint-disable-line function-disallowed-list
  }

  .close {
    position: relative;
    width: var(--#{$prefix}tag-close-size);
    min-width: var(--#{$prefix}tag-close-size); // Here to avoid weird behavior on wrap
    height: var(--#{$prefix}tag-close-size);
    margin: add(calc(var(--#{$prefix}tag-close-size) * -.5), var(--#{$prefix}tag-font-shift)) var(--#{$prefix}tag-close-margin-end) calc(var(--#{$prefix}tag-close-size) * -.5) var(--#{$prefix}tag-close-margin-start); // stylelint-disable-line function-disallowed-list
    color: inherit;
    background-color: transparent;
    border: 0;
    outline-offset: $spacer;
    @include transition($transition-focus);
    @include border-radius(var(--#{$prefix}tag-border-radius), var(--#{$prefix}tag-border-radius));

    &::after {
      position: absolute;
      width: 100%;
      height: 100%;
      content: "";
      background-color: currentcolor;
      transform: translate(-50%, -50%);
      mask-image: escape-svg(url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path d='M24.536 20.298a1.499 1.499 0 0 1 0 2.12l-2.119 2.118a1.499 1.499 0 0 1-2.119 0L15 19.238l-5.298 5.298a1.499 1.499 0 0 1-2.12 0l-2.118-2.119a1.499 1.499 0 0 1 0-2.119L10.762 15 5.464 9.702a1.499 1.499 0 0 1 0-2.12l2.119-2.118a1.499 1.499 0 0 1 2.119 0L15 10.762l5.298-5.298a1.499 1.499 0 0 1 2.12 0l2.118 2.119a1.499 1.499 0 0 1 0 2.119L19.238 15z'/></svg>"));
      mask-repeat: no-repeat;
      mask-position: 50%;
      mask-size: subtract(var(--#{$prefix}tag-close-size), .375rem);
    }

    &:hover,
    &:active {
      color: var(--#{$prefix}tag-active-color);
      background-color: var(--#{$prefix}tag-active-decoration-color);
    }

    &:focus[data-focus-visible-added] {
      outline: .1875rem solid var(--#{$prefix}tag-outline-color);
      outline-offset: .1875rem;
    }

    &[disabled] {
      pointer-events: none;
    }
  }

  &[disabled],
  &.disabled {
    color: var(--#{$prefix}tag-disabled-color);
    pointer-events: none;
    border-color: var(--#{$prefix}tag-disabled-color);
  }
}

// stylelint-disable-next-line selector-no-qualifying-type
button.tag {
  &:hover {
    border-color: var(--#{$prefix}tag-active-decoration-color);
  }

  // stylelint-disable-next-line selector-no-qualifying-type
  &:focus[data-focus-visible-added] {
    outline: .1875rem solid var(--#{$prefix}tag-outline-color);
    outline-offset: .1875rem;
  }

  &:active {
    color: var(--#{$prefix}tag-active-color);
    background-color: var(--#{$prefix}tag-active-decoration-color);
    border-color: var(--#{$prefix}tag-active-decoration-color);
  }
}

.tag-sm {
  --#{$prefix}tag-padding-x: #{$tag-padding-x-sm};
  --#{$prefix}tag-padding-y: #{$tag-padding-y-sm};
  --#{$prefix}tag-font-size: #{$tag-font-size-sm};
  --#{$prefix}tag-icon-size: #{$tag-icon-size-sm};
  --#{$prefix}tag-icon-margin-start: #{$tag-icon-margin-start-sm};
  --#{$prefix}tag-close-margin-end: #{$tag-close-margin-end-sm};
  --#{$prefix}tag-close-margin-start: #{$tag-close-margin-start-sm};
}

.tag-dark {
  --#{$prefix}tag-border-color: #{$tag-border-color-dark};
  --#{$prefix}tag-active-color: #{$tag-active-color-dark};
  --#{$prefix}tag-active-decoration-color: #{$tag-active-decoration-color-dark};
  --#{$prefix}tag-disabled-color: #{$tag-disabled-color-dark};
}
